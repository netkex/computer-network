# HW 3, Павленко Даниил

## Программирование сокетов: Прокси-сервер

### Запуск сервера

Для сборки и запуска сервера достаточно выполнить следующую команду из корня директории [server](server/). 

```bash 
./gradlew run --args="-c config.json"  
```

Где `config.json` - конфигурационный файл сервера в формате `json`, в котором содержится:
* порт сервера 
* директория куда будет сохраняться база данных с информацией об уже загруженных страницах (кэш)
* забаненные url и домены 

[Пример такого файла можно найти здесь](server/config.json).

Пусть сервер запущен на стандартном 8080 порту, тогда запрос к ресурсу будет иметь следующий вид: 
```bash 
http://localhost:8080/natworld.info/wp-content/uploads/2018/02/vodosvinka-ili-kapibara.jpg
```

## Wireshark. Работа с DNS 

### Б. DNS-трассировка www.ietf.org

* ```Найдите DNS-запрос и ответ на него. С использованием какого транспортного протокола они отправлены?```\
Они отправлены с использованием протокола UDP, хотя в сам WireShark показывает, что DNS.

* ```Какой порт назначения у запроса DNS?```\
Порт назначения: 53 

* ```На какой IP-адрес отправлен DNS-запрос? Используйте ipconfig для определения IP-адреса вашего локального DNS-сервера. Одинаковы ли эти два адреса?```\
Запрос отправлен по IP-адресу `192.168.1.1`, что по идее является адресом роутера в локальной сети. Если в командной строке 
поискать адрес DNS сервера, то он выведет тот же самый IP-адрес.
```bash 
(base) netkex@Daniils-MBP ~ % scutil --dns | grep 'nameserver\[[0-9]*\]'
nameserver[0] : 192.168.1.1
nameserver[0] : 192.168.1.1 
```

* ```Проанализируйте сообщение-запрос DNS. Запись какого типа запрашивается? Содержатся ли в запросе какие-нибудь «ответы»? ```\
В качестве ответа так же ожидается `query`: `Response: Message is a query`. В запросе есть отдельное поле 
`answers PRs` и оно равно 0 во всех запросов.

* ```Проанализируйте ответное сообщение DNS. Сколько в нем «ответов»? Что содержится в каждом?```\
В некоторых по 3 ответа, в одном - 2. В них содержатся IP-адреса домена, а также `CNAME`, который мапит 
запрошенное домена в его канонический полный вид. 

* ```Посмотрите на последующий TCP-пакет с флагом SYN, отправленный вашим компьютером. Соответствует ли IP-адрес назначения пакета с SYN одному из адресов, приведенных в ответном сообщении DNS?```\
TCP пакета нет, но есть QUIC пакет, отправленный по адресу, который был в одном из ответов `DNS repsonse`, то есть соответствует домену
`www.ietf.org.cdn.cloudflare.net`. 

* ```Веб-страница содержит изображения. Выполняет ли хост новые запросы DNS перед загрузкой этих изображений?```\
Нет, не выполняет, сразу общается по QUIC с `www.ietf.org.cdn.cloudflare.net`, то есть домены где-то кэшируются. 
